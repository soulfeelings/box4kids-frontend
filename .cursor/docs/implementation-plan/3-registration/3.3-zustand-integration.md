# 3.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Zustand store

**‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2 —á–∞—Å–∞

## üéØ –¶–µ–ª—å

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Zustand store –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

## üìã –®–∞–≥–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ store

**–§–∞–π–ª:** `src/store/index.ts`

```typescript
import { create } from "zustand";
import { devtools, persist } from "zustand/middleware";
import { immer } from "zustand/middleware/immer";
import { User } from "../types/api";

interface AppState {
  // Auth
  user: User | null;
  setUser: (user: User | null) => void;

  // Registration flow
  currentStep: number;
  phone: string;
  code: string;
  name: string;
  setStep: (step: number) => void;
  setPhone: (phone: string) => void;
  setCode: (code: string) => void;
  setName: (name: string) => void;
  reset: () => void;
}

export const useAppStore = create<AppState>()(
  devtools(
    persist(
      immer((set) => ({
        // Auth state
        user: null,
        setUser: (user) => set({ user }),

        // Registration state
        currentStep: 0,
        phone: "",
        code: "",
        name: "",
        setStep: (step) => set({ currentStep: step }),
        setPhone: (phone) => set({ phone }),
        setCode: (code) => set({ code }),
        setName: (name) => set({ name }),
        reset: () =>
          set({
            currentStep: 0,
            phone: "",
            code: "",
            name: "",
          }),
      })),
      { name: "box4kids-store" }
    )
  )
);
```

### 2. –ó–∞–º–µ–Ω–∞ useState –≤ LoginPage

```typescript
// –£–¥–∞–ª—è–µ–º useState, –∏—Å–ø–æ–ª—å–∑—É–µ–º store
const {
  currentStep,
  phone,
  code,
  name,
  setStep,
  setPhone,
  setCode,
  setName,
  setUser,
} = useAppStore();

// –ó–∞–º–µ–Ω—è–µ–º step –Ω–∞ currentStep –∏ setStep
const handleSendCode = async () => {
  // ...
  if (result.success) {
    setStep(Step.Code);
  }
};
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ö—É–∫–æ–≤ –¥–ª—è store

**–§–∞–π–ª:** `src/hooks/store/useRegistration.ts`

```typescript
import { useAppStore } from "../../store";

export const useRegistration = () => {
  const {
    currentStep,
    phone,
    code,
    name,
    setStep,
    setPhone,
    setCode,
    setName,
    reset,
  } = useAppStore();

  return {
    currentStep,
    phone,
    code,
    name,
    setStep,
    setPhone,
    setCode,
    setName,
    reset,
  };
};
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

- [ ] Zustand store –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ
- [ ] useState –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ store
- [ ] –•—É–∫–∏ –¥–ª—è store —Å–æ–∑–¥–∞–Ω—ã

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —à–∞–≥–∏

- **–ü—Ä–µ–¥—ã–¥—É—â–∏–π:** [3.2 –ó–∞–º–µ–Ω–∞ handleRegister](./3.2-register-handler.md)
- **–°–ª–µ–¥—É—é—â–∏–π:** [3.4 –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫](./3.4-error-handling.md)
